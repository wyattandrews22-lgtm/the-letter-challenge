<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>The Letter Challenge</title>
<style>
  body {
    font-family: 'Arial', sans-serif;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    background: #121213;
    color: #fff;
    margin: 0;
    padding: 0;
    height: 100vh;
  }
  h1 {
    margin: 10px 0 20px;
    color: #f3ba2f;
    font-size: 42px;
    text-shadow: 2px 2px #000;
    text-align: center;
  }
  #startScreen {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    padding: 30px;
    border-radius: 12px;
    background: #1e1e1e;
    box-shadow: 0 4px 12px rgba(0,0,0,0.6);
    text-align: center;
  }
  #startScreen h2 { margin-bottom: 20px; color: #f3ba2f; }
  .letters {
    display: grid;
    justify-content: center;
    margin: 20px auto;
    gap: 8px;
  }
  .letter {
    border: 2px solid #3a3a3c;
    border-radius: 6px;
    padding: 15px;
    font-size: 22px;
    width: 55px;
    text-align: center;
    cursor: pointer;
    background: #818384;
    color: #fff;
    font-weight: bold;
    transition: all 0.2s ease;
  }
  .letter:hover { background: #ffb74d; transform: scale(1.1); color: #000; }
  #wordInput {
    font-size: 24px;
    padding: 12px;
    width: 280px;
    text-align: center;
    border: 2px solid #3a3a3c;
    border-radius: 6px;
    background: #1e1e1e;
    color: #fff;
    margin-top: 15px;
    pointer-events: none;
  }
  .controls { margin-top: 15px; display: flex; gap: 15px; justify-content: center; }
  .word-list {
    margin-top: 20px;
    width: 100%;
    max-width: 340px;
    max-height: 220px;
    overflow-y: auto;
    text-align: left;
  }
  .word { padding: 6px; border-bottom: 1px solid #3a3a3c; }
  .score, .timer {
    margin-top: 15px;
    font-size: 22px;
    font-weight: bold;
  }
  .score { color: #4caf50; }
  .timer { color: #f44336; }
  button {
    padding: 14px 22px;
    margin: 8px 0;
    font-size: 20px;
    border-radius: 8px;
    border: none;
    background: #538d4e;
    color: #fff;
    font-weight: bold;
    cursor: pointer;
    transition: background 0.2s ease;
  }
  button:hover { background: #81c784; }
  #gameArea { display: none; flex-direction: column; align-items: center; width: 100%; }
  #gameOverScreen {
    display: none; position: fixed; top: 0; left: 0;
    width: 100%; height: 100%;
    background: rgba(0,0,0,0.95); color: #fff;
    display: flex; flex-direction: column; align-items: center; justify-content: center;
    font-size: 26px; text-align: center; z-index: 10; padding: 20px;
  }
  #gameOverScreen button { margin-top: 20px; }
</style>
</head>
<body>

<h1>The Letter Challenge</h1>

<div id="gameArea">
  <div class="letters" id="letters"></div>
  <input type="text" id="wordInput" readonly>
  <div class="controls">
    <button onclick="submitWord()">‚úîÔ∏è Submit</button>
    <button onclick="undoLetter()">‚Ü©Ô∏è Undo</button>
  </div>
  <div class="timer" id="timer">‚è≥ 60</div>
  <div class="score" id="score">Score: 0</div>
  <div id="versusScores" style="display:none; margin-top:10px;">
    <div id="p1Score">üü¢ Player 1: 0</div>
    <div id="p2Score">üîµ Player 2: 0</div>
    <div id="turnDisplay">Turn: Player 1</div>
  </div>
  <div class="word-list" id="wordList"></div>
</div>

<div id="startScreen">
  <p>Loading dictionary...</p>
</div>

<div id="gameOverScreen">
  <div id="finalScore"></div>
  <button onclick="backToMenu()">üè† Main Menu</button>
</div>

<script>
let dictionary = [];
let letters = [];
let currentWord = [];
let foundWords = new Set();
let score = 0;
let timer, timeLeft = 60;
let currentMode = "basic";

// Versus mode state
let player1Score = 0, player2Score = 0, currentPlayer = 1;

const lettersDiv = document.getElementById("letters");
const wordInput = document.getElementById("wordInput");
const wordListDiv = document.getElementById("wordList");
const scoreDisplay = document.getElementById("score");
const timerDisplay = document.getElementById("timer");

// Load dictionary
fetch("words.txt")
  .then(response => response.text())
  .then(text => {
    dictionary = text.split("\n").map(w => w.trim().toLowerCase()).filter(w => w.length > 0);
    document.getElementById("startScreen").innerHTML = `
      <h2>Choose a Mode</h2>
      <button onclick="startGame('basic')">‚ñ∂Ô∏è Basic Mode</button>
      <button onclick="startGame('terrible')">üíÄ Terrible Tens</button>
      <button onclick="startGame('versus')">‚öîÔ∏è Versus Mode</button>
    `;
  });

function shuffleArray(array){
  for(let i=array.length-1;i>0;i--){
    const j=Math.floor(Math.random()*(i+1));
    [array[i],array[j]]=[array[j],array[i]];
  }
  return array;
}

function pickValidSet(size) {
  while(true) {
    const candidate = shuffleArray("ABCDEFGHIJKLMNOPQRSTUVWXYZ".split('')).slice(0,size).join('');
    let validWords = dictionary.filter(word => 
      word.split('').every(l => candidate.includes(l.toUpperCase()))
    );
    if(validWords.length >= 3) return candidate;
  }
}

function displayLetters(arr, rows=1, cols=arr.length){
  lettersDiv.style.gridTemplateColumns = `repeat(${cols}, 1fr)`;
  lettersDiv.innerHTML="";
  arr.forEach(l=>{
    const div=document.createElement("div");
    div.classList.add("letter");
    div.textContent=l;
    div.onclick=()=>{ currentWord.push(l); renderCurrentWord(); };
    lettersDiv.appendChild(div);
  });
}

function renderCurrentWord(){ wordInput.value=currentWord.join(''); }
function undoLetter(){ currentWord.pop(); renderCurrentWord(); }

function submitWord(){
  const word=currentWord.join('').toLowerCase();
  if(timeLeft<=0) return;
  if(word.length>=2 && dictionary.includes(word) && !foundWords.has(word)){
    if([...word].every(l=>letters.includes(l.toUpperCase()))){
      foundWords.add(word);
      const wordDiv=document.createElement("div");
      wordDiv.classList.add("word");
      wordDiv.textContent=`${(currentMode==='versus' ? (currentPlayer===1?"üü¢":"üîµ"):"")} ${word}`;
      wordListDiv.appendChild(wordDiv);
      if(currentMode==='versus'){
        if(currentPlayer===1){ player1Score+=word.length; }
        else { player2Score+=word.length; }
        document.getElementById("p1Score").textContent=`üü¢ Player 1: ${player1Score}`;
        document.getElementById("p2Score").textContent=`üîµ Player 2: ${player2Score}`;
        currentPlayer= (currentPlayer===1?2:1);
        document.getElementById("turnDisplay").textContent=`Turn: Player ${currentPlayer}`;
      } else {
        score+=word.length;
        scoreDisplay.textContent="Score: "+score;
      }
    }
  }
  currentWord=[]; renderCurrentWord();
}

function startGame(mode){
  currentMode = mode;
  document.getElementById("startScreen").style.display="none";
  document.getElementById("gameArea").style.display="flex";
  score=0; foundWords.clear(); wordListDiv.innerHTML=""; scoreDisplay.textContent="Score: 0"; timeLeft=60;
  player1Score=0; player2Score=0; currentPlayer=1;
  document.getElementById("versusScores").style.display = (mode==='versus') ? "block" : "none";

  let size = (mode === "basic") ? 5 : (mode === "terrible" ? 10 : 20);
  letters=shuffleArray(pickValidSet(size).split(''));
  if(mode==='versus') displayLetters(letters, 4, 5);
  else displayLetters(letters);

  timerDisplay.textContent="‚è≥ "+timeLeft;
  clearInterval(timer);
  timer=setInterval(()=>{
    timeLeft--;
    timerDisplay.textContent="‚è≥ "+timeLeft;
    if(timeLeft<=0){ clearInterval(timer); showGameOver(); }
  },1000);
}

function showGameOver(){
  document.getElementById("gameOverScreen").style.display="flex";
  if(currentMode==='versus'){
    let winnerText = (player1Score>player2Score)?"üèÜ Player 1 Wins!":
                     (player2Score>player1Score)?"üèÜ Player 2 Wins!":"ü§ù It's a Tie!";
    document.getElementById("finalScore").textContent=`Game Over!\n${winnerText}\nüü¢ P1: ${player1Score} | üîµ P2: ${player2Score}`;
  } else {
    document.getElementById("finalScore").textContent="Game Over! Final Score: "+score;
  }
}

function backToMenu(){
  document.getElementById("gameOverScreen").style.display="none";
  document.getElementById("gameArea").style.display="none";
  document.getElementById("startScreen").style.display="flex";
  document.getElementById("startScreen").innerHTML = `
    <h2>Choose a Mode</h2>
    <button onclick="startGame('basic')">‚ñ∂Ô∏è Basic Mode</button>
    <button onclick="startGame('terrible')">üíÄ Terrible Tens</button>
    <button onclick="startGame('versus')">‚öîÔ∏è Versus Mode</button>
  `;
}
</script>
</body>
</html>
